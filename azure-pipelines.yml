pool:
  vmImage: ubuntu-latest

stages:
- stage: Build
  jobs:
  - job: Build
    steps:
    - checkout: self

    - task: CmdLine@2
      displayName: SemGrep SAST
      inputs:
        script: |
         docker run --rm -v "${PWD}:/src" returntocorp/semgrep semgrep scan --config auto -o semgrep-junit.xml --junit-xml
         
    - task: PublishTestResults@2
      displayName: Publish SemGrep Results
      inputs:
        testResultsFormat: "JUnit"
        testResultsFiles: "**/semgrep-junit.xml"
      condition: succeededOrFailed() 

